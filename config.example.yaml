# Code Health Monitor v2 - 配置文件模板
# 使用说明：
# 1. 复制此文件为 config.yaml 或 config/config.yaml
# 2. 根据你的实际情况修改配置
# 3. 敏感信息建议使用环境变量: ${VAR_NAME} 或 ${VAR_NAME:-default}
# 4. config.yaml 不会被提交到 git（已在 .gitignore 中忽略）

# 项目基础配置
project:
  name: "${PROJECT_NAME:-代码健康监控平台}"

# Git 平台配置
git:
  # 平台类型: github, gitlab, codeup, git (默认)
  platform: "${GIT_PLATFORM:-git}"
  # 访问令牌 (GitHub/GitLab/通用Git)
  token: "${GIT_TOKEN}"
  # 组织/用户名 (用于 GitHub/GitLab)
  org: "${GIT_ORG:-}"
  # 自托管 Git 服务器地址 (用于 GitLab)
  base_url: "${GIT_BASE_URL:-}"
  # 云效企业 ID (用于 Codeup，也可通过 CODEUP_ORG_ID 环境变量配置)
  codeup_org_id: "${CODEUP_ORG_ID:-}"
  # 云效项目/命名空间 (用于自动过滤仓库，如 "my-project")
  codeup_project: "${CODEUP_PROJECT:-}"
  # 云效个人访问令牌 (通过 CODEUP_TOKEN 环境变量配置)

# Git 仓库配置 (v2 支持远程 URL)
repositories:
  # 示例：通过 URL 配置 (推荐)
  - name: backend
    url: https://github.com/your-org/backend.git
    type: java
    main_branch: main

  - name: frontend
    url: https://github.com/your-org/frontend.git
    type: vue
    main_branch: main

  # 示例：通过仓库 ID 配置 (用于 Codeup)
  # - id: "12345678"
  #   name: my-service
  #   type: java

  # 也可以通过环境变量配置:
  # REPOSITORIES=backend|https://github.com/org/backend.git|java|main,frontend|https://github.com/org/frontend.git|vue|main

# 风险阈值配置
thresholds:
  large_commit: 500              # 大提交阈值（行）
  tiny_commit: 10                # 微小提交阈值（行）
  churn_days: 3                  # 震荡检测天数
  churn_count: 5                 # 震荡检测次数
  churn_rate_warning: 10         # 震荡率警告阈值（%）
  churn_rate_danger: 30          # 震荡率危险阈值（%）
  rework_add_days: 7             # 返工检测：代码新增后N天内
  rework_delete_days: 3          # 返工检测：被删除视为返工
  rework_rate_warning: 15        # 返工率警告阈值（%）
  rework_rate_danger: 30         # 返工率危险阈值（%）
  hotspot_days: 7                # 热点文件统计天数
  hotspot_count: 10              # 热点修改次数阈值
  large_file: 1000               # 大文件行数阈值
  multi_author_count: 3          # 多人协作文件阈值
  health_score_excellent: 80     # 优秀分数线
  health_score_good: 60          # 良好分数线
  health_score_warning: 40       # 警告分数线

# 工作时间配置
working_hours:
  normal_start: "09:00"
  normal_end: "18:00"
  overtime_start: "18:00"
  overtime_end: "21:00"
  late_night_start: "22:00"
  late_night_end: "06:00"
  weekend_work_warning: true

# 通知配置
notification:
  # 钉钉通知
  dingtalk:
    enabled: ${DINGTALK_ENABLED:-false}
    webhook: "${DINGTALK_WEBHOOK:-}"
    secret: "${DINGTALK_SECRET:-}"

  # 飞书通知
  feishu:
    enabled: ${FEISHU_ENABLED:-false}
    webhook: "${FEISHU_WEBHOOK:-}"

  # Email 通知 (可选)
  email:
    enabled: false
    smtp_server: smtp.example.com
    smtp_port: 587
    smtp_user: ""
    smtp_password: ""
    from: ""
    to: []

# 分析配置
analysis:
  all_branches: true
  exclude_patterns:
    - "*.md"
    - "*.txt"
    - "*.json"
    - "*.xml"
    - "*.yaml"
    - "*.yml"
    - "package-lock.json"
    - "pom.xml"
    - ".gitignore"
    - "LICENSE"
  exclude_dirs:
    - node_modules
    - .git
    - .idea
    - __pycache__
    - target
    - build
    - dist
    - venv
    - .venv

# Web 访问配置
web:
  base_url: "${WEB_BASE_URL:-http://localhost:8080}"
